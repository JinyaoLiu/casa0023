<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>0023RS - 7&nbsp; Classification II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Week9.html" rel="next">
<link href="./Week7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Week8.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">0023RS</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started with remote sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Portfolio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data processing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">temperature</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="header-section-number">7.1</span> Summary</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition"><span class="header-section-number">7.1.1</span> Definition</a></li>
  <li><a href="#part-1-land-cover-classification" id="toc-part-1-land-cover-classification" class="nav-link" data-scroll-target="#part-1-land-cover-classification"><span class="header-section-number">7.1.2</span> Part 1: Land Cover Classification</a></li>
  <li><a href="#part-2-accuracy" id="toc-part-2-accuracy" class="nav-link" data-scroll-target="#part-2-accuracy"><span class="header-section-number">7.1.3</span> Part 2: Accuracy</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">7.1.4</span> Cross Validation</a></li>
  </ul></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="header-section-number">7.2</span> Application</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">7.3</span> Reflection</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7.4</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">7.1</span> Summary</h2>
<section id="definition" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="definition"><span class="header-section-number">7.1.1</span> Definition</h3>
<p>OBIA: - Superpixels = Consider shapes based on the similarity (homogeneity) or difference (heterogeneity) of the cells</p>
</section>
<section id="part-1-land-cover-classification" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="part-1-land-cover-classification"><span class="header-section-number">7.1.2</span> Part 1: Land Cover Classification</h3>
<p><big><strong>Object based image analysis (OBIA)</strong></big></p>
<p>Most common method: SLIC (Simple Linear Iterative Clustering)</p>
<ul>
<li>work out spatial distance (from regular points on the image to centre of pixel) and colour difference</li>
<li>Package: SegOptim</li>
</ul>
<p><big><strong>Sub pixel analysis</strong></big></p>
<p>Remotely sensed images often present a mix of both pure and mixed pixels. Traditional hard classification methods assign mixed pixels to the class with the highest coverage or probability, inevitably leading to information loss. To address this issue, soft classification techniques have been introduced. These methods allocate pixel fractions to the corresponding land cover classes based on the area represented within a pixel. However, this approach does not provide information about the spatial distribution of these fractions within the pixel.</p>
<p><span class="citation" data-cites="atkinson1997innovations">Atkinson (<a href="#ref-atkinson1997innovations" role="doc-biblioref">1997</a>)</span> proposed a solution by suggesting the spatial assignment of fractions to sub-pixels within each pixel. This divides every pixel into a predefined number of sub-pixels, enabling a more detailed representation of lower-resolution pixels. Sub-pixel mapping algorithms have been applied in various forms and on fraction images with different spatial resolutions. However, assessing the accuracy of these algorithms poses challenges due to the lack of high-resolution ground truth imagery.</p>
<p>To overcome this limitation, high-resolution reference classifications are degraded to generate artificial fraction images. These artificial fraction images are then used as input for the sub-pixel mapping process, with the original reference image serving as ground truth. This approach facilitates the accuracy assessment of sub-pixel mapping algorithms. This study aims to utilize identical reference images across different sub-pixel mapping techniques, enabling a comparative evaluation of their performance.</p>
<p>EXAMPLE:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">band</th>
<th style="text-align: center;">water</th>
<th style="text-align: center;">vegeration</th>
<th style="text-align: center;">soil</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">5v</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">60</td>
</tr>
</tbody>
</table>
<span class="math display">\[\begin{align*}
\begin{bmatrix}
\text{band } 3\\
\text{band } 4\\
\text{sum to } 1
\end{bmatrix} &amp;= \begin{bmatrix}
p_{\text{water}} &amp; p_{\text{veg}} &amp; p_{\text{soil}}\\
p_{\text{water}} &amp; p_{\text{veg}} &amp; p_{\text{soil}}\\
1 &amp; 1 &amp; 1
\end{bmatrix}\begin{bmatrix}
f_{\text{water}} \\
f_{\text{veg}}\\
f_{\text{soil}}
\end{bmatrix}
\end{align*}\]</span>
<p><em>Step 1:</em> take the inverse matrix of endmembers</p>
<span class="math display">\[\begin{align*}
\begin{bmatrix}
13 &amp; 22 &amp; 70\\
5 &amp; 80 &amp; 60\\
1 &amp; 1 &amp; 1
\end{bmatrix} \to \begin{bmatrix}
-0.0053 &amp; -0.0127&amp; 1.1322\\
-0.0145&amp; 0.0150 &amp; 0.1137\\
0.0198 &amp; -0.0024 &amp; -0.2460
\end{bmatrix}
\end{align*}\]</span>
<p><em>Step 2:</em> solve if band 3 = 25 and band 4 = 57</p>
<span class="math display">\[\begin{align*}
\begin{bmatrix}
f_{\text{water}} \\
f_{\text{veg}}\\
f_{\text{soil}}
\end{bmatrix} &amp;= \begin{bmatrix}
-0.0053 &amp; -0.0127&amp; 1.1322\\
-0.0145&amp; 0.0150 &amp; 0.1137\\
0.0198 &amp; -0.0024 &amp; -0.2460
\end{bmatrix}\begin{bmatrix}
25 \\
57\\
1
\end{bmatrix}
\end{align*}\]</span>
<p>Thus get:</p>
<span class="math display">\[\begin{bmatrix}
0.27 \\
0.61\\
0.11
\end{bmatrix}\]</span>
<p>27% water, 61% vegetation and 11% soil</p>
</section>
<section id="part-2-accuracy" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="part-2-accuracy"><span class="header-section-number">7.1.3</span> Part 2: Accuracy</h3>
<p align="center">
</p><p><img src="fig/week8/fig1.png" alt="Alt Text" width="500"></p>
<p></p>
<p align="right">
</p><p><em>Confusion matrix</em></p>
<p></p>
<p>wiki:confusion_matrix</p>
<ul>
<li><p>Kappa</p>
<ul>
<li><span class="math inline">\(k = \frac{p_{o}-p_{e}}{1 - p_e}\)</span></li>
<li><span class="math inline">\(p_o\)</span>: the propotyion of cases correctly classified(accuracy) <span class="math inline">\(=\frac{TP+TN}{TP+TN+FP+FN}\)</span></li>
<li><span class="math inline">\(p_e\)</span>: expected cased correctly classified by chance</li>
</ul></li>
<li><p>F1-score</p>
<ul>
<li><span class="math inline">\(F1 = \frac{2*Precesion*Recall}{Precision+Recall}\)</span> or</li>
<li><span class="math inline">\(F1 = \frac{TP}{TP+\frac{1}{2}*(FP+FN)}\)</span></li>
<li>values from 0 to 1, larger F1-score, better performance.</li>
</ul></li>
<li><p>ROC curve</p>
<ul>
<li><span class="math inline">\(True\ positive\ rate = \frac{TP}{TP+FN}\)</span></li>
<li><span class="math inline">\(False\ positive\ rate = \frac{FP}{FP+TN}\)</span></li>
<li>Goal: Maximise true positives and minimise false positives</li>
<li>Area Under the ROC Curve (AUC, or AUROC): Perfect value will be 1, random will be 0.5</li>
</ul></li>
</ul>
</section>
<section id="cross-validation" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">7.1.4</span> Cross Validation</h3>
<p>Dividing the data set into the training set and the test set, using only one data set as the test set and all the other data as the training set, repeats this step N times (N is the number of data in the data set).</p>
<p align="center">
</p><p><img src="fig/week8/fig2.png" alt="Alt Text" width="300"></p>
<p></p>
<p align="right">
</p><p><span class="citation" data-cites="phdthesis">(<a href="#ref-phdthesis" role="doc-biblioref">Bliem 2020</a>)</span></p>
<p></p>
<p><big><strong>Spatial cross validation</strong></big>: same as cross validation but with clustering to the folds</p>
<p align="center">
</p><p><img src="fig/week8/fig3.png" alt="Alt Text" width="300"></p>
<p></p>
<p align="right">
</p><p><span class="citation" data-cites="spatial-cv">(<a href="#ref-spatial-cv" role="doc-biblioref">GeoCompX contributors 2018</a>)</span></p>
<p></p>
</section>
</section>
<section id="application" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="application"><span class="header-section-number">7.2</span> Application</h2>
<p>The various accuracy tests we spent a large part of the lecture talking about are actually some fixed methods for scoring models. They are used to analyze the results of almost all models. At the same time, they have little room for research.</p>
<p>As for spatial cross-validation, many papers will apply this validation method to reduce the influence of spatial dependence structure between data on fitting and prediction ability.Especially in recent years, it seems that the effect of spatial dependence on model results has been noticed by more and more researchers.<span class="citation" data-cites="deppner2024accounting Beigait allen2020permutation">(<a href="#ref-deppner2024accounting" role="doc-biblioref">Deppner and Cajias 2024</a>; <a href="#ref-Beigait" role="doc-biblioref">Beigaitė, Mechenich, and Žliobaitė 2022</a>; <a href="#ref-allen2020permutation" role="doc-biblioref">Allen, Kim, and Yang 2020</a>)</span> Before looking for relevant materials, I thought that this method was a verification method similar to confusion matrix. In fact, to my surprise, some scholars are still considering how to improve this method.</p>
<p><span class="citation" data-cites="leRest2014spatial">Le Rest et al. (<a href="#ref-leRest2014spatial" role="doc-biblioref">2014</a>)</span>’s research assesses an alternative method employing a spatial cross-validation technique. While this technique is typically utilized for model assessment, it can also yield valuable insights for variable selection in the presence of spatial autocorrelation. The study proposes the use of a specific form of spatial cross-validation known as spatial leave-one-out (SLOO), which offers a criterion akin to the AIC when spatial autocorrelation is absent. SLOO exclusively computes non-spatial models and employs a threshold distance (equivalent to the range of RSA) to ensure spatial independence for each omitted point. The study initially conducts simulations to compare SLOO’s performance with that of AIC. It proves particularly advantageous when the range of RSA is limited, a characteristic often observed in spatial tools. Consequently, SLOO emerges as a promising approach for selecting pertinent variables from a wide range of ecological spatial datasets.</p>
</section>
<section id="reflection" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">7.3</span> Reflection</h2>
<p>I found the exploration of spatial cross-validation particularly intriguing. While I initially perceived it as a standard validation method, <span class="citation" data-cites="leRest2014spatial">Le Rest et al. (<a href="#ref-leRest2014spatial" role="doc-biblioref">2014</a>)</span>’s research introduced me to the concept of spatial leave-one-out (SLOO) cross-validation. This innovative approach, which accounts for spatial autocorrelation, showed promise in variable selection for ecological spatial datasets. It was fascinating to learn about ongoing efforts to refine and improve spatial validation techniques, highlighting the dynamic nature of research in this field.</p>
</section>
<section id="references" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="references"><span class="header-section-number">7.4</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-allen2020permutation" class="csl-entry" role="listitem">
Allen, D., A. Y. Kim, and J. Yang. 2020. <span>“A Permutation Test and Spatial Cross-Validation Approach to Assess Models of Interspecific Competition Between Trees.”</span> <em>PLoS ONE</em> 15 (3): e0229930. <a href="https://link-gale-com.libproxy.ucl.ac.uk/apps/doc/A617101249/AONE?u=ucl_ttda&amp;sid=bookmark-AONE&amp;xid=489db22e">https://link-gale-com.libproxy.ucl.ac.uk/apps/doc/A617101249/AONE?u=ucl_ttda&amp;sid=bookmark-AONE&amp;xid=489db22e</a>.
</div>
<div id="ref-atkinson1997innovations" class="csl-entry" role="listitem">
Atkinson, Peter M. 1997. <span>“Innovations in GIS 4 Chap. 12.”</span> In <em>Taylor &amp; Francis</em>, 166–80. London, U.K.
</div>
<div id="ref-Beigait" class="csl-entry" role="listitem">
Beigaitė, Rita, Michael Mechenich, and Indrė Žliobaitė. 2022. <span>“Spatial Cross-Validation for Globally Distributed Data.”</span> In <em>Discovery Science</em>, edited by Poncelet Pascal and Dino Ienco, 127–40. Cham: Springer Nature Switzerland.
</div>
<div id="ref-phdthesis" class="csl-entry" role="listitem">
Bliem, Christian. 2020. <span>“Estimation of the (Re-)integration Likelihood into the Austrian Labour Market: A Random Forest Approach (Christian Bliem, 2020).”</span> PhD thesis. <a href="https://doi.org/10.13140/RG.2.2.33476.96648">https://doi.org/10.13140/RG.2.2.33476.96648</a>.
</div>
<div id="ref-deppner2024accounting" class="csl-entry" role="listitem">
Deppner, J., and M. Cajias. 2024. <span>“Accounting for Spatial Autocorrelation in Algorithm-Driven Hedonic Models: A Spatial Cross-Validation Approach.”</span> <em>J Real Estate Finan Econ</em> 68: 235–73. <a href="https://doi.org/10.1007/s11146-022-09915-y">https://doi.org/10.1007/s11146-022-09915-y</a>.
</div>
<div id="ref-spatial-cv" class="csl-entry" role="listitem">
GeoCompX contributors. 2018. <span>“Spatial Cross-Validation.”</span> <a href="https://r.geocompx.org/spatial-cv.html" class="uri">https://r.geocompx.org/spatial-cv.html</a>.
</div>
<div id="ref-leRest2014spatial" class="csl-entry" role="listitem">
Le Rest, K., D. Pinaud, P. Monestiez, J. Chadoeuf, and V. Bretagnolle. 2014. <span>“Spatial Leave-One-Out Cross-Validation for Variable Selection in the Presence of Spatial Autocorrelation.”</span> <em>Global Ecology and Biogeography</em> 23 (7/8): 811–20. <a href="http://www.jstor.org/stable/24034076">http://www.jstor.org/stable/24034076</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Week7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Week9.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">temperature</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>